<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Payment</title>
  <style>
    .summary {
      margin: 20px;
      font-size: 18px;
    }
    .summary ul {
      list-style: none;
      padding: 0;
    }
    .summary li {
      margin-bottom: 10px;
    }
    .error {
      color: red;
      font-size: 14px;
    }
  </style>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      const total = localStorage.getItem('total') || 0;

      const summaryElement = document.getElementById('cart-summary');
      if (cart.length > 0) {
        const list = document.createElement('ul');
        cart.forEach(item => {
          const listItem = document.createElement('li');
          listItem.textContent = `${item.quantity} x ${item.ticketType} @ $${item.price} each`;
          list.appendChild(listItem);
        });
        summaryElement.appendChild(list);
        summaryElement.innerHTML += `<p>Total: $${total}</p>`;
      } else {
        summaryElement.textContent = 'No items in cart.';
      }

      const paymentFormElement = document.getElementById('payment-form');

      paymentFormElement.addEventListener('submit', (event) => {
        event.preventDefault();
        if (validateForm()) {
          window.location.href = 'receipt.html';
        }
      });

      function validateForm() {
        const cardNumber = document.getElementById('card-number').value;
        const cardExpiry = document.getElementById('card-expiry').value;
        const cardCvc = document.getElementById('card-cvc').value;

        clearErrors();

        let isValid = true;

        if (!/^\d{16}$/.test(cardNumber)) {
          showError('card-number', 'Card number must be 16 digits.');
          isValid = false;
        }

        if (!/^(0[1-9]|1[0-2])\/\d{2}$/.test(cardExpiry)) {
          showError('card-expiry', 'Expiry date must be in MM/YY format.');
          isValid = false;
        }

        if (!/^\d{3}$/.test(cardCvc)) {
          showError('card-cvc', 'CVC must be 3 digits.');
          isValid = false;
        }

        return isValid;
      }

      function showError(fieldId, message) {
        const field = document.getElementById(fieldId);
        const error = document.createElement('div');
        error.className = 'error';
        error.textContent = message;
        field.parentElement.appendChild(error);
      }

      function clearErrors() {
        document.querySelectorAll('.error').forEach(error => error.remove());
      }
    });
  </script>
</head>
<body>
<h1>Payment</h1>

<div class="summary" id="cart-summary"></div>

<section id="payment-form">
  <h2>Pay with Card</h2>
  <form id="payment-form" method="post">
    <label for="card-number">Card Number</label>
    <input type="text" id="card-number" name="card-number" required>

    <label for="card-expiry">Expiry Date (MM/YY)</label>
    <input type="text" id="card-expiry" name="card-expiry" required>

    <label for="card-cvc">CVC</label>
    <input type="text" id="card-cvc" name="card-cvc" required>

    <button type="submit">Submit Payment</button>
  </form>
</section>
</body>
</html>
